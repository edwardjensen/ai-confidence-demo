# AI Confidence Demonstration Tool

A web-based tool that demonstrates AI confidence levels using OpenRouter API and log probabilities visualization.

For a detailed explanation of how this works and the concepts behind AI confidence measurement, see the supplemental blog post: [AI Confidence Probabilities](https://www.edwardjensen.net/posts/2025/2025-06/ai-confidence-probabilities)

## Features

- Interactive chat interface with AI
- Real-time confidence visualization using color-coded tokens
- Hover tooltips showing exact confidence percentages and alternatives
- **Token usage tracking** - See input, output, and total tokens for each exchange
- **Improved tooltip system** - No more overlapping tooltips, clean display
- Clean, modern UI with responsive design (75% screen width)
- Log probabilities analysis for each AI response token
- **Production deployment** - Deploy to Cloudflare Pages with automated publishing/unpublishing

## Files

- `logprobs.html` - Main HTML interface
- `styles.css` - CSS styling
- `script.js` - JavaScript functionality
- `server.js` - Node.js Express web server
- `package.json` - NPM configuration and dependencies

## Quick Start

### Prerequisites

Make sure you have Node.js installed (version 14 or higher). You can download it from [nodejs.org](https://nodejs.org/).

### Installation and Setup

1. **Install dependencies:**

```bash
npm install
```

2. **Configure API Key (Optional - for automatic loading):**

Create a `.env.local` file in the project root with your OpenRouter API key:

```bash
OPENROUTER_API_KEY=sk-or-v1-your-actual-api-key-here
```

If you create this file, the application will automatically load your API key and skip the manual input step.

3. **Start the server:**

```bash
npm start
```

### Alternative NPM Commands

- `npm run dev` - Start development server
- `npm run serve` - Start server (same as start)

The server will automatically:

- Find an available port (starting from 3000)
- Open your default browser to the application
- Display the server URL in the terminal

## Setup

1. Start the server using one of the methods above
2. **Automatic Setup (Recommended)**: If you have a `.env.local` file with your API key, the application will automatically load it and be ready to use
3. **Manual Setup**: If no environment file is found, enter your OpenRouter API key when prompted
4. Start chatting with the AI
5. Hover over colored tokens to see confidence levels and alternatives

## API Key Configuration

You'll need an OpenRouter API key to use this tool. Get one at [openrouter.ai](https://openrouter.ai/).

### Method 1: Environment Variable (Recommended for Development)

Create a `.env.local` file in the project root:

```bash
OPENROUTER_API_KEY=sk-or-v1-your-actual-api-key-here
```

Benefits:

- Automatic loading on startup
- No need to enter the key manually each time
- Secure local development workflow

### Method 2: Manual Entry

If you don't have a `.env.local` file, the application will prompt you to enter your API key manually through the web interface.

The tool uses the `openai/gpt-4o-mini` model with log probabilities enabled to show confidence levels.

## How It Works

### Confidence Visualization

- **Green tokens**: High confidence (>70%)
- **Yellow tokens**: Medium confidence (30-70%)  
- **Red tokens**: Low confidence (<30%)

### Interactive Features

Hover over any colored token to see:

- Exact confidence percentage
- Alternative token possibilities with their probabilities

### Token Usage Tracking

Each AI response shows:

- **Input tokens**: Number of tokens in your message
- **Output tokens**: Number of tokens generated by the AI
- **Total tokens**: Combined count for the exchange

This helps you monitor API usage and understand the cost implications of your conversations.

## Requirements

- Node.js 14.x or higher
- Modern web browser
- OpenRouter API key
- Internet connection

## Installation

1. Clone or download this repository
1. Install dependencies:

   ```bash
   npm install
   ```

1. Start the server:

   ```bash
   npm start
   ```

## Security Notes

- **API Key Safety**: Your OpenRouter API key is only stored in your browser's memory and is never sent to any server other than OpenRouter's official API
- **Local Server**: The web server runs locally on your machine and does not collect or transmit any data
- **Environment Variables**: When using `.env.local`, your API key is only accessible to your local development server and never exposed to external services
- **Client-Side Processing**: All confidence visualization happens in your browser

## Browser Compatibility

Works with all modern browsers including:

- Chrome/Chromium
- Firefox
- Safari
- Edge

## Deployment Options

### Local Development

Perfect for testing and development with manual API key input.

### Production Deployment

Deploy to Cloudflare Pages with pre-configured API key and automated workflows.
ðŸ“– **See [PRODUCTION.md](PRODUCTION.md) for complete setup guide**
